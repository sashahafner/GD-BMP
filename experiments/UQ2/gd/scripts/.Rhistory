setwd("~/GitHub/GD-BMP/experiments/UQ2/gd/scripts")
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
#source('biogas.R')
source('cumBgGDcomparison.R')       # includes all methods
# Calculate BMP, yld and BMPo
# source('BMP.R')
source('BMPcomp.R')
#cbg.gd$method <- 'gd'
cbg.gd1$method <- 'gd1'
cbg.gd2$method <- 'gd2'
cbg.gd3$method <- 'gd3'
# cbg.gd4$method <- 'gd4'
cbg.gd5$method <- 'gd5'
# cbg.gd6$method <- 'gd6'
#cbg.gd7$method <- 'gd7'
cbg.gd8$method <- 'gd8'
# Plot all gd methods composition in one plot
cbg.gd.all <- biogas:::rbindf(
cbg.gd1, cbg.gd2, cbg.gd3,
#cbg.gd4,
cbg.gd5,
#cbg.gd6, cbg.gd7,
cbg.gd8
# cbg.gd9,
# cbg.gd10,
# cbg.gd11, cbg.gd12
)
ggplot(cbg.gd.all, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition Comparison') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.png')
# Negative xCH4
ggplot(cbg.gd7, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id))
# Negative xCH4
ggplot(cbg.gd1, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id))
# ---------------
ggplot(cbg.gd1, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.gd1.png')
# ---------------
#gd1
ggplot(cbg.gd1, aes(elapsed.time, xCH4,  group_by(id) colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
View(cbg.gd1)
# ---------------
#gd1
ggplot(cbg.gd1, aes(elapsed.time, xCH4,  group_by(descrip) colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
# Some other possibilities . . .
# cbg.gd$pid <- interaction(cbg.gd$descrip, cbg.gd$method)
ggplot(cbg.gd, aes(elapsed.time, cvCH4, group = pid)) +
geom_line(aes(colour = )) +
facet_wrap(~ descrip)
# Some other possibilities . . .
# cbg.gd$pid <- interaction(cbg.gd$descrip, cbg.gd$method)
ggplot(cbg.gd, aes(elapsed.time, cvCH4, group = id)) +
geom_line(aes(colour = )) +
facet_wrap(~ descrip)
# ---------------
#gd1
ggplot(cbg.gd1, aes(elapsed.time, xCH4,  group = id, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
# ---------------
#gd1
ggplot(cbg.gd1, aes(elapsed.time, xCH4,  group_by = id, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
# ---------------
#gd1
ggplot(cbg.gd1, aes(elapsed.time, xCH4,  group_by(id), colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
# ---------------
#gd1
ggplot(cbg.gd1, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd1') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.gd1.png')
# gd2
ggplot(cbg.gd2, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd2') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.gd2.png')
#gd1
ggplot(cbg.gd3, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd3') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.gd5.png')
ggsave('../plots/xCH4.gd8.png')
#gd8
ggplot(cbg.gd8, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd8') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.gd8.png')
#gd3
ggplot(cbg.gd3, aes(elapsed.time, xCH4, colour = descrip)) +
geom_point() + geom_line(aes(group = id)) +
labs(x = 'Time [d]', y = 'CH4 Composition', colour = 'Substrate')  +
ggtitle('Composition gd3') +
theme_bw() +
theme(text = element_text(size = 8)) +
facet_grid(method ~. )   # What is the best grid after adding all (or chosen) gd methods
ggsave('../plots/xCH4.gd3.png')
# Some other possibilities . . .
# cbg.gd$pid <- interaction(cbg.gd$descrip, cbg.gd$method)
ggplot(cbg.gd, aes(elapsed.time, cvCH4, group = id)) +
geom_line(aes(colour = )) +
facet_wrap(~ descrip)
ggplot(yld, aes(elapsed.time, mean, group = pid)) +
geom_line(aes(colour = method)) +
facet_wrap(~ descrip)
# More interesting with yld
yld$pid <- interaction(yld$descrip, yld$method)
ggplot(yld, aes(elapsed.time, mean, group = pid)) +
geom_line(aes(colour = method)) +
facet_wrap(~ descrip)
# Plot mean data for each substrate (with ino and substrate correction)
ggplot(BMP, aes(method, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
geom_hline(yintercept = predBg("C6H10O5"), linetype = "dashed", color = "lightblue", size = 1) +
geom_hline(yintercept = predBg("C18H32O8N"),linetype = "dashed", color = "red", size = 1) +
labs(x = 'Method', y = 'Mean Cumulative CH4 [mL]', colour = 'Description')  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/method_comparison_BMP.png')
# Runs complete analysis of UQ2gd data
# Camilla G. Justesen
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
#source('biogas.R')
source('cumBgGDcomparison.R')       # includes all methods
# Calculate BMP, yld and BMPo
# source('BMP.R')
source('BMPcomp.R')
# Clean data prior to analysis
source('merge.R')
# Graphical comparison of methods
source('plots.R')
source('xCH4.plots.R')
# Export results
source('export_results.R')
# Export manipulated results
source('export_manipulated.R')
# Calculate maximum theoretical BMP for the substrates
source('theoretical_BMP.R')
# Runs complete analysis of UQ2gd data
# Camilla G. Justesen
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
#source('biogas.R')
source('cumBgGDcomparison.R')       # includes all methods
# Calculate BMP, yld and BMPo
# source('BMP.R')
source('BMPcomp.R')
# Clean data prior to analysis
source('merge.R')
# Graphical comparison of methods
source('plots.R')
View(cbg.gd)
#Extract xCH4
gd1comp <- cbg.gd1[, c(cbg.gd1$id, cbg.gd1$elapsed.time, cbg.gd1$descrip, cbg.gd1$xCH4]
#Extract xCH4
gd1comp <- cbg.gd1[, c(cbg.gd1$id, cbg.gd1$elapsed.time, cbg.gd1$descrip, cbg.gd1$xCH4)]
View(cbg.gd1)
#Extract xCH4
gd1comp <- cbg.gd1[c(cbg.gd1$id, cbg.gd1$elapsed.time, cbg.gd1$descrip, cbg.gd1$xCH4), ]
View(gd1comp)
#Extract xCH4
gd1comp <- cbg.gd1[, c(cbg.gd1$id, cbg.gd1$elapsed.time, cbg.gd1$descrip, cbg.gd1$xCH4)]
#Extract xCH4
gd1comp <- cbg.gd1[, c('id', 'elapsed.time', 'descrip', 'xCH4')]
#Extract xCH4
gd1comp <- cbg.gd1[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
#cbg.gd$method <- 'gd'
cbg.gd1$method <- 'gd1'
#Extract xCH4
gd1comp <- cbg.gd1[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
gd2comp <- cbg.gd2[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
cbg.gd2$method <- 'gd2'
cbg.gd3$method <- 'gd3'
# cbg.gd4$method <- 'gd4'
cbg.gd5$method <- 'gd5'
# cbg.gd6$method <- 'gd6'
#cbg.gd7$method <- 'gd7'
cbg.gd8$method <- 'gd8'
gd2comp <- cbg.gd2[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
gd3comp <- cbg.gd3[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
gd5comp <- cbg.gd8[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
gd8comp <- cbg.gd8[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
gd5comp <- cbg.gd5[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
merge(gd1comp1, gdcomp2, by =c('id', 'elapsed.time', 'descrip', 'method'))
merge(gd1comp, gdcomp2, by =c('id', 'elapsed.time', 'descrip', 'method'))
merge(gd1comp, gd2comp, by =c('id', 'elapsed.time', 'descrip', 'method'))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip', 'method'))
merge(gd1comp, gd2comp))
merge(gd1comp, gd2comp)
View(gd2comp)
merge(gd1comp, gd2comp, by = 'id')
merge(gd1comp, gd2comp, by = c'id', 'elapsed.time'))
merge(gd1comp, gd2comp, by = c'id', 'elapsed.time'))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time'))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip', suffixes = c('gd1', 'gd2')))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip', suffixes = c(".gd1",".gd2")))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c(".gd1",".gd2")))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c(".gd1",".gd2"))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c(".gd",".gd2"))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c("gd","gd2"))
merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c("_gd1","_gd2"))
gdcomp <- merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c("_gd1","_gd2"))
merge(gdcomp, gd3comp, by = c('id', 'elapsed.time', 'descrip')))
merge(gdcomp, gd3comp, by = c('id', 'elapsed.time', 'descrip'))
suffixes = c("_gd1","_gd2"
merge(gdcomp, gd3comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c("_gd1","_gd3"))
merge(gdcomp, gd3comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c(,"_gd3"))
merge(gdcomp, gd3comp, by = c('id', 'elapsed.time', 'descrip'), suffixes = c( ,"_gd3"))
gd1comp$xCH4_gd1 <- gd1comp$xCH4
gd1comp$xCH4 <- gd1comp$xCH4_gd1
gd2comp$xCH4 <- gd2comp$xCH4_gd2
View(gd2comp)
gd2comp <- cbg.gd2[, c('id', 'elapsed.time', 'descrip', 'xCH4', 'method')]
gd2comp$xCH4 <- gd2comp$xCH4_gd2
#Extract xCH4
cbg.gd1$xCH4_gd1 <- cbg.gd1$xCH4
gd1comp <- cbg.gd1[, c('id', 'elapsed.time', 'descrip', 'xCH4_gd1')]
cbg.gd2$xCH4_gd2 <- cbg.gd2$xCH4
cbg.gd3$xCH4_gd3 <- cbg.gd3$xCH4
cbg.gd5$xCH4_gd5 <- cbg.gd5$xCH4
cbg.gd8$xCH4_gd8 <- cbg.gd8$xCH4
gd2comp <- cbg.gd2[, c('id', 'elapsed.time', 'descrip', 'xCH4_gd2')]
gd3comp <- cbg.gd3[, c('id', 'elapsed.time', 'descrip', 'xCH4_gd3')]
gd5comp <- cbg.gd5[, c('id', 'elapsed.time', 'descrip', 'xCH4_gd5')]
gd8comp <- cbg.gd8[, c('id', 'elapsed.time', 'descrip', 'xCH4_gd8')]
gdcomp <- merge(gd1comp, gd2comp, by = c('id', 'elapsed.time', 'descrip'))
gdcomp <- merge(gdcomp, gd3comp, by = c('id', 'elapsed.time', 'descrip'))
View(gdcomp)
gdcomp <- merge(gdcomp, gd5comp, by = c('id', 'elapsed.time', 'descrip'))
gdcomp <- merge(gdcomp, gd8comp, by = c('id', 'elapsed.time', 'descrip'))
write.csv(gdcomp, '../results/gdxCH4')
