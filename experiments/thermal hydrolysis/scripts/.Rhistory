# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Calculation of water detection limits and drift
source('water_detect_lim.R')
source('drift_correction.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Export raw data
source('export.R')
# Calculate biogas production
#source('biogas.R')
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
#source('BMP.R')
source('BMPcomp.R')
# Export results
source('export_results.R')
ggplot(yld2.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
ggplot(yld, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
View(yld)
yld.1 <- subset(yld, method == "gd03" | method == "grav")
ggplot(yld, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
View(yld.1)
yld.1 <- subset(yld, method == "gd03" | method == "grav")
# Plots
# Yield plot
sub.lab <- c("Cellulose" = "Cellulose", "FIC" = "D) Feed ingredient C", "LBD" = "Lignocellulosic biomass")
yld.1 <- subset(yld, method == "gd03" | method == "grav")
ggplot(yld, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
# Plots
# Yield plot
sub.lab <- c("Cellulose" = "A) Cellulose", "FIC" = "B) Feed ingredient C", "LBD" = "C) Lignocellulosic biomass")
yld.1 <- subset(yld, method == "gd03" | method == "grav")
ggplot(yld, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 3)
setwd("~/GitHub/GD-BMP/experiments/thermal hydrolysis/scripts")
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Export raw data
source('export.R')
# Calculate biogas production
source('biogas.R')
# Calculate BMP, yld and BMPo
source('BMP.R')
# Clean data prior to analysis
source('merge.R')
View(yld)
yld.1 <- subset(yld, method == "gd03" | method == "grav")
View(yld.1)
yld.1.2 <- subset(yld.1, descrip == 'Cellulose' | descrip == 'Ethanol' | descrip == 'Raw sludge'| descrip == 'Sludge C1' | descrip == 'Sludge C2')
View(yld.1.2)
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller()) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 3)
facet_wrap(~ descrip + theme_bw() +
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 3)
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" )
# Yield plot
sub.lab <- c("Cellulose" = "A) Cellulose", "Ethanol" = "B) Ethanol", "Raw sludge" = "C) Raw sludge", "Sludge C1" = "D) Sludge C1", "Sludge C2" = "E) Sludge C2")
yld.1 <- subset(yld, method == "gd03" | method == "grav")
yld.1.2 <- subset(yld.1, descrip == 'Cellulose' | descrip == 'Ethanol' | descrip == 'Raw sludge'| descrip == 'Sludge C1' | descrip == 'Sludge C2')
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller()) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 3)
ggplot(yld.1, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 3)
# Yield plot
sub.lab <- c("Cellulose" = "A) Cellulose", "Ethanol" = "B) Ethanol", "Raw sludge" = "C) Raw sludge", "Sludge C1" = "D) Sludge C1", "Sludge C2" = "E) Sludge C2")
yld.1 <- subset(yld, method == "gd03" | method == "grav")
yld.1.2 <- subset(yld.1, descrip == 'Cellulose' | descrip == 'Ethanol' | descrip == 'Raw sludge'| descrip == 'Sludge C1' | descrip == 'Sludge C2')
ggplot(yld.1.2, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 3)
ggplot(yld.1.2, aes(elapsed.time, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
scale_color_hue(labels = c("GD", "Gravimetric")) +
labs(x = 'Time [d]', y = expression('CH'[4]*' yield [mL/g]'), colour = "Method" , theme()) +
facet_wrap(~ descrip, labeller = as_labeller(sub.lab)) + theme_bw() +
theme(text = element_text(size = 10), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/yld.png', width = 8, height = 6)
View(BMP)
labels <- c(gd01 = 'GD01', gd02 = 'GD02', gd03 = 'GD03', gd04 = 'GD04', gd05 = 'GD05', gd06 = 'GD06',
gd07 = 'GD07', gd08 = 'GD08', gd09 = 'GD09', gd10 = 'GD10', gd11 = 'GD11', gd12 = 'GD12',
grav = 'Gravimetric', vol = 'Volumetric', man = 'Manometric')
BMP$method.label <- labels[BMP$method]
BMP$lwr <- BMP$mean - BMP$sd
BMP$upr <- BMP$mean + BMP$sd
ggplot(BMP) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method.label), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP [mL/g]'), fill = 'Method') + theme_bw() +
theme(legend.title = element_blank(), legend.position = "right" ) +
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars_good_substrate.pdf', height = 6, width = 6, scale = 1.2)
ggsave('../plots/BMP2_comp_bars_good_substrate.png', height = 6, width = 6, scale = 1.2)
View(biogas)
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
source('BMP.R')
# Clean data prior to analysis
source('merge.R')
labels <- c(gd01 = 'GD01', gd02 = 'GD02', gd03 = 'GD03', gd04 = 'GD04', gd05 = 'GD05', gd06 = 'GD06',
gd07 = 'GD07', gd08 = 'GD08', gd09 = 'GD09', gd10 = 'GD10', gd11 = 'GD11', gd12 = 'GD12',
grav = 'Gravimetric', vol = 'Volumetric', man = 'Manometric')
BMP$method.label <- labels[BMP$method]
BMP$lwr <- BMP$mean - BMP$sd
BMP$upr <- BMP$mean + BMP$sd
ggplot(BMP) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method.label), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP [mL/g]'), fill = 'Method') + theme_bw() +
theme(legend.title = element_blank(), legend.position = "right" ) +
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars_good_substrate.pdf', height = 6, width = 6, scale = 1.2)
View(BMP)
cbg.list <- list(vol = cbg.vol, man = cbg.man, grav = cbg.grav, gd01 = cbg.gd1, gd02 = cbg.gd2, gd03 = cbg.gd3, gd04 = cbg.gd4, gd05 = cbg.gd5, gd06 = cbg.gd6,
gd07 = cbg.gd7, gd08 = cbg.gd8, gd09 = cbg.gd9, gd10 = cbg.gd10, gd11 = cbg.gd11, gd12 = cbg.gd12)
BMP <- summBg(cbg.list, setup, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method')
# Graphical comparison of methods
source('plots.R')
# Clean data prior to analysis
source('merge.R')
# Runs complete analysis of thermal hydrolysis data
# Camilla G. Justesen
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Export raw data
source('export.R')
# Calculate biogas production
source('biogas.R')
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
source('BMP.R')
#source('BMPcomp.R')
labels <- c(gd01 = 'GD01', gd02 = 'GD02', gd03 = 'GD03', gd04 = 'GD04', gd05 = 'GD05', gd06 = 'GD06',
gd07 = 'GD07', gd08 = 'GD08', gd09 = 'GD09', gd10 = 'GD10', gd11 = 'GD11', gd12 = 'GD12',
grav = 'Gravimetric', vol = 'Volumetric', man = 'Manometric')
BMP$method.label <- labels[BMP$method]
BMP$lwr <- BMP$mean - BMP$sd
BMP$upr <- BMP$mean + BMP$sd
ggplot(BMP) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method.label), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP [mL/g]'), fill = 'Method') + theme_bw() +
theme(legend.title = element_blank(), legend.position = "right" ) +
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars_good_substrate.pdf', height = 6, width = 6, scale = 1.2)
BMP <- subset(BMP, descrip == 'Cellulose' | descrip == 'Ethanol' | descrip == 'Raw sludge'| descrip == 'Sludge C1' | descrip == 'Sludge C2')
BMP$lwr <- BMP$mean - BMP$sd
BMP$upr <- BMP$mean + BMP$sd
ggplot(BMP) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method.label), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP [mL/g]'), fill = 'Method') + theme_bw() +
theme(legend.title = element_blank(), legend.position = "right" ) +
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars_good_substrate.pdf', height = 6, width = 6, scale = 1.2)
ggsave('../plots/BMP2_comp_bars_good_substrate.png', height = 6, width = 6, scale = 1.2)
ggsave('../plots/BMP.all.methods.appendix.png', height = 6, width = 6, scale = 1.2)
ggplot(BMP) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method.label), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP [mL/g]'), fill = 'Method') + theme_bw() +
theme(legend.title = element_blank(), legend.position = "right" ) +
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP.all.methods.appendix.pdf', height = 6, width = 6, scale = 1.2)
