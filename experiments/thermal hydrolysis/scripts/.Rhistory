# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Clean data
source('clean.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Export raw data
source('export.R')
# Calculate biogas production
source('biogas.R')
# Calculate BMP, yld and BMPo
source('BMP.R')
# Clean data prior to analysis
source('merge.R')
# Graphical comparison of methods
source('plots.R')
source('xCH4.plots.R')
# Export results
source('export_results.R')
# Export manipulated results
source('export_manipulated.R')
# Compare gd methods
source('compare.R')
View(vari)
# Plots for R4 bad data
BMP.gd03.06.grav <- subset(BMP, method == 'gd03' | method == 'gd06' | method == 'grav')
BMP.gd03.06.grav$lwr <- BMP.gd03.06.grav$mean - BMP.gd03.06.grav$sd
BMP.gd03.06.grav$upr <- BMP.gd03.06.grav$mean + BMP.gd03.06.grav$sd
ggplot(BMP.gd03.06.grav) +
geom_col(aes(method, mean, fill = descrip), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(method, ymin = lwr, ymax = upr, group = descrip), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(BMP.gd03.06.grav, aes(method.label, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Method', y = expression('BMP CH'[4]*' [mL/g]'), colour = 'Method')  +
theme_bw() +
theme(text = element_text(size = 10), axis.text.x = element_text(angle = 90), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/scatter_R4C.png')
ggplot(BMP.gd03.06.grav, aes(method, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Method', y = expression('BMP CH'[4]*' [mL/g]'), colour = 'Method')  +
theme_bw() +
theme(text = element_text(size = 10), axis.text.x = element_text(angle = 90), legend.title = element_blank(), legend.position = "right" ) +
ggsave('../plots/scatter_R4C.png')
ggplot(BMP.gd03.06.grav) +
geom_col(aes(method, mean, fill = descrip), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(method, ymin = lwr, ymax = upr, group = descrip), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(BMP.gd03.06.grav) +
geom_col(aes(method, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(method, ymin = lwr, ymax = upr, group = descrip), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(method, ymin = lwr, ymax = upr, group = descrip), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/barplot_R4A.all.png')
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 40, hjust = 1))
(angle = 20, hjust = 1)
(angle = 20, hjust = 1)
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 20, hjust = 1), legend.title = element_blank())
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 50, hjust = 1), legend.title = element_blank())
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.title = element_blank())
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') +
theme(axis.text.x = element_text(angle = 70, hjust = 1), legend.title = element_blank())
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Method', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') + theme_bw()+
theme(axis.text.x = element_text(angle = 70, hjust = 1), legend.title = element_blank())
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/barplot_R4A.all.png')
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/barplot_R4A.all.png', width = 5, height = 3)
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') + theme_bw()+
theme(axis.text.x = element_text(angle = 70, hjust = 1), legend.title = element_blank())
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/barplot_R4A.all.png', width = 5, height = 3)
BMP.gd03.06.grav$method.label <- factor(BMP.gd03.06.grav$method, levels = c('gd03', 'gd06', 'grav' ), labels = c('Total mass', 'Vented mass', 'Gravimetric'))
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP'~(mL~g^'-1')), fill = 'Substrate') + theme_bw()+
theme(axis.text.x = element_text(angle = 70, hjust = 1), legend.title = element_blank())
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/barplot_R4A.all.png', width = 5, height = 3)
ggplot(BMP.gd03.06.grav) +
geom_col(aes(descrip, mean, fill = method.label), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP [mL/g]'), fill = 'Substrate') + theme_bw()+
theme(axis.text.x = element_text(angle = 70, hjust = 1), legend.title = element_blank())
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/barplot_R4A.all.png', width = 5, height = 3)
