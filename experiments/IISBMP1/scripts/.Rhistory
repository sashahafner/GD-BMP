# Load packages
source('packages.R')
# Load data
source('load.R')
# Subsetting to get rid of missing values
source('subset.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
source('biogas.R')
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
# source('BMP.R')
source('BMPcomp.R')
# Clean data prior to analysis
source('merge.R')
# Bind by rows
cbg.vol$method <- 'vol'
cbg.man$method <- 'man'
cbg.grav$method <- 'grav'
cbg.gd$method <- 'gd'
cbg.gd1$method <- 'gd1'
cbg.gd2$method <- 'gd2'
cbg.gd3$method <- 'gd3'
# cbg.gd4$method <- 'gd4'
cbg.gd5$method <- 'gd5'
# cbg.gd6$method <- 'gd6'
# cbg.gd7$method <- 'gd7'
cbg.gd8$method <- 'gd8'
cbg.all <- biogas:::rbindf(#cbg.vol, cbg.man, cbg.grav, cbg.gd,
cbg.gd1, cbg.gd2, gbg.gd3,
#cbg.gd4,
cbg.gd5,
#cbg.gd6,
#cbg.gd7,
cbg.gd8
#cbg.gd9, cbg.gd10, cbg.gd11, cbg.gd12
)
# Add substrate type and other needed variables with merge of some columns from setup
cbg.all <- merge(cbg.all, setup[, c('id', 'descrip')], by = 'id')
# Runs complete analysis of IISBMP1 data
# Camilla G. Justesen
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Subsetting to get rid of missing values
source('subset.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
source('biogas.R')
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
# source('BMP.R')
source('BMPcomp.R')
# Set BMP duration for all calls
when.BMP <- 29
# Make a list of each experiment for all methods
cbg.vol.list <- split(cbg.vol, cbg.vol$exper)
cbg.man.list <- split(cbg.man, cbg.man$exper)
cbg.grav.list <- split(cbg.grav, cbg.grav$exper)
#cbg.gd.list <- split(cbg.gd, cbg.gd$exper)
cbg.gd1.list <- split(cbg.gd1, cbg.gd1$exper)
cbg.gd2.list <- split(cbg.gd2, cbg.gd2$exper)
cbg.gd3.list <- split(cbg.gd3, cbg.gd3$exper)
# cbg.gd4.list <- split(cbg.gd4, cbg.gd4$exper)
cbg.gd5.list <- split(cbg.gd5, cbg.gd5$exper)
# Experiment 1
cbg.list.1 <- list(
vol = cbg.vol.list[[1]], man = cbg.man.list[[1]], grav = cbg.grav.list[[1]],
gd = cbg.gd.list[[1]],
#gd1 = cbg.gd1.list[[1]], gd2 = cbg.gd2.list[[1]], gd3 = cbg.gd3.list[[1]], gd4 = cbg.gd4.list[[1]], gd5 = cbg.gd5.list[[1]], gd6 = cbg.gd6.list[[1]],
gd7 = cbg.gd7.list[[1]], gd8 = cbg.gd8.list[[1]], gd9 = cbg.gd9.list[[1]], gd10 = cbg.gd10.list[[1]], gd11 = cbg.gd11.list[[1]], gd12 = cbg.gd12.list[[1]]
)
# cbg.gd6.list <- split(cbg.gd6, cbg.gd6$exper)
# cbg.gd7.list <- split(cbg.gd7, cbg.gd7$exper)
cbg.gd8.list <- split(cbg.gd8, cbg.gd8$exper)
BMP1 <- summBg(cbg.list.1, setup1, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method')
# Experiment 1
cbg.list.1 <- list(
vol = cbg.vol.list[[1]], man = cbg.man.list[[1]], grav = cbg.grav.list[[1]],
gd = cbg.gd.list[[1]],
#gd1 = cbg.gd1.list[[1]], gd2 = cbg.gd2.list[[1]], gd3 = cbg.gd3.list[[1]], gd4 = cbg.gd4.list[[1]], gd5 = cbg.gd5.list[[1]], gd6 = cbg.gd6.list[[1]],
gd7 = cbg.gd7.list[[1]], gd8 = cbg.gd8.list[[1]], gd9 = cbg.gd9.list[[1]], gd10 = cbg.gd10.list[[1]], gd11 = cbg.gd11.list[[1]], gd12 = cbg.gd12.list[[1]]
)
# Calculate BMP, yld and BMPo
source('BMP.R')
cbg.gd.list <- split(cbg.gd, cbg.gd$exper)
# Experiment 1
cbg.list.1 <- list(
vol = cbg.vol.list[[1]], man = cbg.man.list[[1]], grav = cbg.grav.list[[1]],
#gd = cbg.gd.list[[1]],
#gd1 = cbg.gd1.list[[1]], gd2 = cbg.gd2.list[[1]], gd3 = cbg.gd3.list[[1]], gd4 = cbg.gd4.list[[1]], gd5 = cbg.gd5.list[[1]], gd6 = cbg.gd6.list[[1]],
gd7 = cbg.gd7.list[[1]], gd8 = cbg.gd8.list[[1]], gd9 = cbg.gd9.list[[1]], gd10 = cbg.gd10.list[[1]], gd11 = cbg.gd11.list[[1]], gd12 = cbg.gd12.list[[1]]
)
# Experiment 1
cbg.list.1 <- list(
vol = cbg.vol.list[[1]], man = cbg.man.list[[1]], grav = cbg.grav.list[[1]],
#gd = cbg.gd.list[[1]],
gd1 = cbg.gd1.list[[1]], gd2 = cbg.gd2.list[[1]], gd3 = cbg.gd3.list[[1]],
#gd4 = cbg.gd4.list[[1]],
gd5 = cbg.gd5.list[[1]],
#gd6 = cbg.gd6.list[[1]],
#gd7 = cbg.gd7.list[[1]],
gd8 = cbg.gd8.list[[1]]
#gd9 = cbg.gd9.list[[1]], gd10 = cbg.gd10.list[[1]], gd11 = cbg.gd11.list[[1]], gd12 = cbg.gd12.list[[1]]
)
BMP1 <- summBg(cbg.list.1, setup1, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method')
# BMPo
BMPo1 <- summBg(cbg.list.1, setup1, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method', show.obs = TRUE)
# yld for yield
#yld <- ... when = 'meas')
yld1 <- summBg(cbg.list.1, setup1, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = 'meas', extrap = TRUE, set.name = 'method')
# Experiment 2
cbg.list.2 <- list(
#vol = cbg.vol.list[[2]], man = cbg.man.list[[2]], grav = cbg.grav.list[[2]],
#gd = cbg.gd.list[[2]],
gd1 = cbg.gd1.list[[2]], gd2 = cbg.gd2.list[[2]], gd3 = cbg.gd3.list[[2]],
#gd4 = cbg.gd4.list[[2]],
gd5 = cbg.gd5.list[[2]],
#gd6 = cbg.gd6.list[[2]],
#gd7 = cbg.gd7.list[[2]],
gd8 = cbg.gd8.list[[2]]
#gd9 = cbg.gd9.list[[2]], gd10 = cbg.gd10.list[[2]], gd11 = cbg.gd11.list[[2]], gd12 = cbg.gd12.list[[2]]
)
######################################################
BMP2 <- summBg(cbg.list.2, setup2, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method')
# o for "obs" = one value for each bottle
#BMPo <- ... show.obs = TRUE)
BMPo2 <- summBg(cbg.list.2, setup2, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method', show.obs = TRUE)
# yld for yield
#yld <- ... when = 'meas')
yld2 <- summBg(cbg.list.2, setup2, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = 'meas', extrap = TRUE, set.name = 'method')
# Merge data for each three result into one data frame for exper1+exper2
# Add column to each set to have experiment given in data frame
BMP1$exper <- 1
BMP2$exper <- 2
BMPo1$exper <- 1
BMPo2$exper <- 2
yld1$exper <- 1
yld2$exper <- 2
# Runs complete analysis of IISBMP1 data
# Camilla G. Justesen
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Subsetting to get rid of missing values
source('subset.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
source('biogas.R')
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
source('BMP.R')
source('BMPcomp.R')
# Clean data prior to analysis
source('merge.R')
cbg.all <- biogas:::rbindf(#cbg.vol, cbg.man, cbg.grav, cbg.gd,
cbg.gd1, cbg.gd2, gbg.gd3,
#cbg.gd4,
cbg.gd5,
#cbg.gd6,
#cbg.gd7,
cbg.gd8
#cbg.gd9, cbg.gd10, cbg.gd11, cbg.gd12
)
cbg.all <- biogas:::rbindf(#cbg.vol, cbg.man, cbg.grav, cbg.gd,
cbg.gd1, cbg.gd2, cbg.gd3,
#cbg.gd4,
cbg.gd5,
#cbg.gd6,
#cbg.gd7,
cbg.gd8
#cbg.gd9, cbg.gd10, cbg.gd11, cbg.gd12
)
# Runs complete analysis of IISBMP1 data
# Camilla G. Justesen
# Load functions
source('functions.R')
# Load packages
source('packages.R')
# Load data
source('load.R')
# Subsetting to get rid of missing values
source('subset.R')
# Clean data
source('clean.R')
# Export raw data
source('export.R')
# Calculation of water detection limits
source('water_detect_lim.R')
# Calculate leakage from biogas bottles
source('leak.R')
# Calculate biogas production
source('biogas.R')
source('cumBgGDcomparison.R')
# Calculate BMP, yld and BMPo
source('BMP.R')
source('BMPcomp.R')
# Clean data prior to analysis
source('merge.R')
# # More interesting with yld
yld1$pid <- interaction(yld1$descrip, yld1$method)
ggplot(yld1, aes(elapsed.time, mean, group = pid)) +
geom_line(aes(colour = method)) +
facet_wrap(~ descrip)
ggsave('../plots/yld.interaction_exper1.png')
yld2$pid <- interaction(yld2$descrip, yld2$method)
ggplot(yld2, aes(elapsed.time, mean, group = pid)) +
geom_line(aes(colour = method)) +
facet_wrap(~ descrip)
ggsave('../plots/yld.interaction_exper2.png')
# Plot of data before corrected for inoculum (grav) - maybe change coloring for descrip (need to add descrip column)
ggplot(cbg.grav.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("Gravimetric") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/gravimetric_biogas_exper1.png')
# Plot of data before corrected for inoculum (vol)
ggplot(cbg.vol.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("Volumetric") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/volumetric_biogas_exper1.png')
# Plot of data before corrected for inoculum (man)
ggplot(cbg.man.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("Manometric") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/manometric_biogas_exper1.png')
# Plot of data before corrected for inoculum (GD)
ggplot(cbg.gd.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("GD Method") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/GD_biogas_exper1.png')
# All plots above are made for experiment 1, not 2
# for exper 2
# Plot of data before corrected for inoculum (grav) - maybe change coloring for descrip (need to add descrip column)
ggplot(cbg.grav.list[[2]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("Gravimetric") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/gravimetric_biogas_exper2.png')
# Plot of data before corrected for inoculum (vol)
ggplot(cbg.vol.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("Volumetric") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/volumetric_biogas_exper2.png')
# Plot of data before corrected for inoculum (man)
ggplot(cbg.man.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("Manometric") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/manometric_biogas_exper2.png')
# Plot of data before corrected for inoculum (GD)
ggplot(cbg.gd.list[[1]], aes(elapsed.time, cvCH4, colour = id, group = id.exper )) +
geom_point() +
geom_line() +
ggtitle("GD Method") +
labs(x = "Elapsed Time [day]", y = "Cumulative CH4 [mL]", colour = "Substrate")  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/GD_biogas_exper2.png')
# Plot mean data for each substrate (with ino and substrate correction)
ggplot(BMP1, aes(method, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Method', y = 'Mean Cumulative CH4 [mL]', colour = 'Description')  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/method_comparison_BMP_exper1.png')
ggplot(BMP2, aes(method, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Method', y = 'Mean Cumulative CH4 [mL]', colour = 'Description')  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/method_comparison_BMP_exper2.png')
# Plot with reverse of method/descrip [1]
ggplot(BMP1, aes(descrip, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/method_comparison_BMP_reverse_exper1.png')
# Plot with reverse of method/descrip [2]
ggplot(BMP2, aes(descrip, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/method_comparison_BMP_reverse_exper2.png')
ggplot(BMP2, aes(method, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Method', y = 'Mean Cumulative CH4 [mL]', colour = 'Description')  +
theme_bw() +
theme(text = element_text(size = 10))
View(BMP2)
# Set BMP duration for all calls
when.BMP <- 29
# Make a list of each experiment for all methods
# cbg.vol.list <- split(cbg.vol, cbg.vol$exper)
# cbg.man.list <- split(cbg.man, cbg.man$exper)
# cbg.grav.list <- split(cbg.grav, cbg.grav$exper)
# cbg.gd.list <- split(cbg.gd, cbg.gd$exper)
cbg.gd1.list <- split(cbg.gd1, cbg.gd1$exper)
cbg.gd2.list <- split(cbg.gd2, cbg.gd2$exper)
cbg.gd3.list <- split(cbg.gd3, cbg.gd3$exper)
# cbg.gd4.list <- split(cbg.gd4, cbg.gd4$exper)
cbg.gd5.list <- split(cbg.gd5, cbg.gd5$exper)
# cbg.gd6.list <- split(cbg.gd6, cbg.gd6$exper)
# cbg.gd7.list <- split(cbg.gd7, cbg.gd7$exper)
cbg.gd8.list <- split(cbg.gd8, cbg.gd8$exper)
# Experiment 2
cbg.list.2 <- list(
#vol = cbg.vol.list[[2]], man = cbg.man.list[[2]], grav = cbg.grav.list[[2]],
#gd = cbg.gd.list[[2]],
gd1 = cbg.gd1.list[[2]], gd2 = cbg.gd2.list[[2]], gd3 = cbg.gd3.list[[2]],
#gd4 = cbg.gd4.list[[2]],
gd5 = cbg.gd5.list[[2]],
#gd6 = cbg.gd6.list[[2]],
#gd7 = cbg.gd7.list[[2]],
gd8 = cbg.gd8.list[[2]]
#gd9 = cbg.gd9.list[[2]], gd10 = cbg.gd10.list[[2]], gd11 = cbg.gd11.list[[2]], gd12 = cbg.gd12.list[[2]]
)
BMP2 <- summBg(cbg.list.2, setup2, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method')
View(BMP2)
# Plot with reverse of method/descrip [2]
ggplot(BMP2, aes(descrip, mean, colour = method)) +
geom_point() + geom_line(aes(group = method)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Description', y = 'Mean Cumulative CH4 [mL]', colour = 'Method')  +
theme_bw() +
theme(text = element_text(size = 10))
ggplot(BMP2, aes(method, mean, colour = descrip)) +
geom_point() + geom_line(aes(group = descrip)) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(0.05)) +
labs(x = 'Method', y = 'Mean Cumulative CH4 [mL]', colour = 'Description')  +
theme_bw() +
theme(text = element_text(size = 10))
ggsave('../plots/method_comparison_BMP_exper2.png')
# Cellulose
predBg("C6H10O5")
# Ethanol
predBg("C2H6OH")
# Substrate A
predBg("C17H31O13N")
# Substrate C
predBg("C18H32O8N")
# Substrate B
predBg("C23H38O16N")
ggplot(BMP1) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP'~(mL~g^'-1')), fill = 'Method') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Barplot option
BMP1$lwr <- BMP1$mean - BMP1$sd
BMP1$upr <- BMP1$mean + BMP1$sd
BMP2$lwr <- BMP2$mean - BMP2$sd
BMP2$upr <- BMP2$mean + BMP2$sd
ggplot(BMP2) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP'~(mL~g^'-1')), fill = 'Method') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf', height = 6, width = 6, scale = 1.2)
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf', height = 6, width = 6, scale = 1.2)
theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf', height = 6, width = 6, scale = 1.2)
ggplot(BMP2) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP'~(mL~g^'-1')), fill = 'Method') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf', height = 6, width = 6, scale = 1.2)
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf',
#height = 6, width = 6, scale = 1.2
)
ggplot(BMP2) +
geom_col(aes(descrip, mean, fill = method), position = 'dodge', colour  = 'black') +
geom_errorbar(aes(descrip, ymin = lwr, ymax = upr, group = method), position = 'dodge', colour = 'gray55') +
#facet_grid(. ~ exper, scales = 'free_x') +
labs(x = 'Substrate', y = expression('BMP'~(mL~g^'-1')), fill = 'Method') +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf')
#theme_bw() + scale_fill_manual(values = c('gray65', 'gray95'))  +
#theme(legend.position = 'none')
ggsave('../plots/BMP2_comp_bars.pdf', height = 6, width = 6, scale = 1.2)
ggsave('../plots/BMP2_comp_bars.pdf)
ggsave('../plots/BMP2_comp_bars.png)
ggsave('../plots/BMP2_comp_bars.png')
View(BMP2)
View(cbg.gd1)
View(cbg.gd8)
# Experiment 2
cbg.list.2 <- list(
#vol = cbg.vol.list[[2]], man = cbg.man.list[[2]], grav = cbg.grav.list[[2]],
#gd = cbg.gd.list[[2]],
gd1 = cbg.gd1.list[[2]], gd2 = cbg.gd2.list[[2]], gd3 = cbg.gd3.list[[2]],
#gd4 = cbg.gd4.list[[2]],
gd5 = cbg.gd5.list[[2]],
#gd6 = cbg.gd6.list[[2]],
#gd7 = cbg.gd7.list[[2]],
gd8 = cbg.gd8.list[[2]]
#gd9 = cbg.gd9.list[[2]], gd10 = cbg.gd10.list[[2]], gd11 = cbg.gd11.list[[2]], gd12 = cbg.gd12.list[[2]]
)
BMP2 <- summBg(cbg.list.2, setup2, id.name = "id",
time.name = 'elapsed.time', descrip.name = 'descrip',
inoc.name = "I", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
when = when.BMP, extrap = TRUE, set.name = 'method')
View(BMP2)
View(cbg.gd.list)
View(cbg.gd1.list)
View(cbg.gd1)
View(no.leaks2)
